/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/datasets/load.py:1486: FutureWarning: The repository for super_glue contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/super_glue
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
2025-03-02 20:26:04,560 - INFO - Sample train set 1500/27243
2025-03-02 20:26:04,561 - INFO - ... including dev set 500 samples
2025-03-02 20:26:04,561 - INFO - Loading model with FP16...
/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
78


Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [02:16<00:00, 45.53s/it]
2025-03-02 20:28:22,706 - INFO - Done with 138.14s
2025-03-02 20:28:23,038 - INFO - Inject lora to: model.decoder.layers.0.self_attn
2025-03-02 20:28:23,894 - INFO - Inject lora to: model.decoder.layers.1.self_attn
2025-03-02 20:28:24,689 - INFO - Inject lora to: model.decoder.layers.2.self_attn
2025-03-02 20:28:25,471 - INFO - Inject lora to: model.decoder.layers.3.self_attn
2025-03-02 20:28:26,166 - INFO - Inject lora to: model.decoder.layers.4.self_attn
2025-03-02 20:28:26,859 - INFO - Inject lora to: model.decoder.layers.5.self_attn
2025-03-02 20:28:27,588 - INFO - Inject lora to: model.decoder.layers.6.self_attn
2025-03-02 20:28:28,318 - INFO - Inject lora to: model.decoder.layers.7.self_attn
2025-03-02 20:28:29,043 - INFO - Inject lora to: model.decoder.layers.8.self_attn
2025-03-02 20:28:29,753 - INFO - Inject lora to: model.decoder.layers.9.self_attn
2025-03-02 20:28:30,459 - INFO - Inject lora to: model.decoder.layers.10.self_attn
2025-03-02 20:28:31,144 - INFO - Inject lora to: model.decoder.layers.11.self_attn
2025-03-02 20:28:31,839 - INFO - Inject lora to: model.decoder.layers.12.self_attn
2025-03-02 20:28:32,530 - INFO - Inject lora to: model.decoder.layers.13.self_attn
2025-03-02 20:28:33,218 - INFO - Inject lora to: model.decoder.layers.14.self_attn
2025-03-02 20:28:33,925 - INFO - Inject lora to: model.decoder.layers.15.self_attn
2025-03-02 20:28:34,623 - INFO - Inject lora to: model.decoder.layers.16.self_attn
2025-03-02 20:28:35,376 - INFO - Inject lora to: model.decoder.layers.17.self_attn
2025-03-02 20:28:36,089 - INFO - Inject lora to: model.decoder.layers.18.self_attn
2025-03-02 20:28:36,785 - INFO - Inject lora to: model.decoder.layers.19.self_attn
2025-03-02 20:28:37,494 - INFO - Inject lora to: model.decoder.layers.20.self_attn
2025-03-02 20:28:38,170 - INFO - Inject lora to: model.decoder.layers.21.self_attn
2025-03-02 20:28:38,890 - INFO - Inject lora to: model.decoder.layers.22.self_attn
2025-03-02 20:28:39,582 - INFO - Inject lora to: model.decoder.layers.23.self_attn
2025-03-02 20:28:40,275 - INFO - Inject lora to: model.decoder.layers.24.self_attn
2025-03-02 20:28:40,981 - INFO - Inject lora to: model.decoder.layers.25.self_attn
2025-03-02 20:28:41,662 - INFO - Inject lora to: model.decoder.layers.26.self_attn
2025-03-02 20:28:42,348 - INFO - Inject lora to: model.decoder.layers.27.self_attn
2025-03-02 20:28:43,023 - INFO - Inject lora to: model.decoder.layers.28.self_attn
2025-03-02 20:28:43,749 - INFO - Inject lora to: model.decoder.layers.29.self_attn
2025-03-02 20:28:44,439 - INFO - Inject lora to: model.decoder.layers.30.self_attn
2025-03-02 20:28:45,132 - INFO - Inject lora to: model.decoder.layers.31.self_attn
2025-03-02 20:28:45,819 - INFO - Inject lora to: model.decoder.layers.32.self_attn
2025-03-02 20:28:46,518 - INFO - Inject lora to: model.decoder.layers.33.self_attn
2025-03-02 20:28:47,206 - INFO - Inject lora to: model.decoder.layers.34.self_attn
2025-03-02 20:28:47,920 - INFO - Inject lora to: model.decoder.layers.35.self_attn
2025-03-02 20:28:48,612 - INFO - Inject lora to: model.decoder.layers.36.self_attn
2025-03-02 20:28:49,330 - INFO - Inject lora to: model.decoder.layers.37.self_attn
2025-03-02 20:28:50,022 - INFO - Inject lora to: model.decoder.layers.38.self_attn
2025-03-02 20:28:50,715 - INFO - Inject lora to: model.decoder.layers.39.self_attn
2025-03-02 20:28:51,425 - INFO - Dev samples: 500
2025-03-02 20:28:51,425 - INFO - Train samples: 1000
2025-03-02 20:28:51,426 - INFO - Eval sample length is 1000
2025-03-02 20:28:51,426 - INFO - Tokenizing training samples...
### layer-wise gradient sparsity = None
-------------------------- Training Epoch 0 --------------------------
2025-03-02 20:29:01,931 - INFO - Done with 10.51s
/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
2025-03-02 20:29:01,955 - INFO - ***** Running training *****
2025-03-02 20:29:01,955 - INFO -   Num examples = 1000
2025-03-02 20:29:01,955 - INFO -   Num Epochs = 318
2025-03-02 20:29:01,955 - INFO -   Instantaneous batch size per device = 16
2025-03-02 20:29:01,955 - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 16
2025-03-02 20:29:01,955 - INFO -   Gradient Accumulation steps = 1
2025-03-02 20:29:01,955 - INFO -   Total optimization steps = 20000
2025-03-02 20:29:01,957 - INFO -   Number of trainable parameters = 6553600
  0%|                                                                                                                                                  | 0/20000 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 534735.4831695557, 'epoch': 0.02}

  0%|                                                                                                                                    | 2/20000 [17:32<2913:52:15, 524.55s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                    | 3/20000 [27:02<3030:45:38, 545.62s/it]
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 570683.287858963, 'epoch': 0.05}
[debugging] num blocks: 43


  0%|                                                                                                                                    | 5/20000 [46:50<3194:40:30, 575.19s/it]
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 593941.3249492645, 'epoch': 0.08}
[debugging] num blocks: 43


  0%|                                                                                                                                  | 7/20000 [1:04:48<3042:50:02, 547.90s/it]
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 464849.6091365814, 'epoch': 0.11}
[debugging] num blocks: 43

  0%|                                                                                                                                  | 8/20000 [1:11:38<2798:26:09, 503.92s/it]
[debugging] num blocks: 43


  0%|                                                                                                                                 | 10/20000 [1:28:58<2825:14:51, 508.80s/it]
[debugging] num blocks: 43
{'loss': 0.7201, 'learning_rate': 1e-08, 'epoch': 0.16}
{'peak_mem': 45.079598903656006, 'step_consumption': 481802.03437805176, 'epoch': 0.16}
[debugging] num blocks: 43


  0%|                                                                                                                                 | 12/20000 [1:41:35<2454:51:18, 442.14s/it]
[debugging] num blocks: 43
{'peak_mem': 45.079598903656006, 'step_consumption': 387454.0390968323, 'epoch': 0.19}
[debugging] num blocks: 43


  0%|                                                                                                                                 | 14/20000 [1:54:05<2269:27:50, 408.79s/it]
[debugging] num blocks: 43
{'peak_mem': 45.079598903656006, 'step_consumption': 386879.9352645874, 'epoch': 0.22}
[debugging] num blocks: 43


  0%|                                                                                                                                 | 16/20000 [2:10:38<2521:24:42, 454.22s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                 | 17/20000 [2:20:14<2723:12:53, 490.60s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                 | 18/20000 [2:27:32<2636:14:18, 474.95s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                 | 19/20000 [2:33:36<2450:53:14, 441.58s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 20/20000 [2:40:10<2370:51:53, 427.18s/it]
[debugging] num blocks: 43
{'loss': 0.7102, 'learning_rate': 1e-08, 'epoch': 0.32}

  0%|▏                                                                                                                                | 21/20000 [2:46:36<2303:28:18, 415.06s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 22/20000 [2:54:17<2379:33:01, 428.79s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 23/20000 [3:04:32<2688:28:32, 484.48s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 24/20000 [3:12:57<2723:18:31, 490.78s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 24/20000 [3:12:57<2723:18:31, 490.78s/it][34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 2.3 seconds.), retrying request
  0%|▏                                                                                                                                | 25/20000 [3:19:01<2512:38:04, 452.84s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 364311.5165233612, 'epoch': 0.4}

  0%|▏                                                                                                                                | 26/20000 [3:25:14<2379:24:33, 428.85s/it]
{'peak_mem': 48.82130432128906, 'step_consumption': 372875.8454322815, 'epoch': 0.41}
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 27/20000 [3:31:22<2277:53:24, 410.57s/it]
[debugging] num blocks: 43


  0%|▏                                                                                                                                | 29/20000 [3:43:06<2104:01:19, 379.27s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 30/20000 [3:49:36<2121:35:08, 382.46s/it]
[debugging] num blocks: 43
{'loss': 0.725, 'learning_rate': 1e-08, 'epoch': 0.48}

  0%|▏                                                                                                                                | 31/20000 [3:55:36<2085:18:00, 375.94s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 32/20000 [4:01:17<2026:10:46, 365.30s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 33/20000 [4:07:13<2010:48:19, 362.54s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 34/20000 [4:13:11<2002:55:52, 361.14s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 35/20000 [4:19:35<2040:27:40, 367.93s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 36/20000 [4:25:20<2002:44:42, 361.14s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 37/20000 [4:30:40<1934:24:50, 348.84s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                | 38/20000 [4:36:37<1948:24:18, 351.38s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 39/20000 [4:42:19<1932:34:59, 348.54s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 40/20000 [4:48:03<1924:45:18, 347.15s/it]
[debugging] num blocks: 43
{'loss': 0.7614, 'learning_rate': 1e-08, 'epoch': 0.63}
{'peak_mem': 48.82130432128906, 'step_consumption': 343889.408826828, 'epoch': 0.63}
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 41/20000 [4:53:35<1898:46:15, 342.48s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 42/20000 [5:00:39<2033:53:17, 366.87s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 43/20000 [5:07:02<2060:43:21, 371.73s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 44/20000 [5:12:00<1938:08:54, 349.64s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 45/20000 [5:19:27<2099:52:11, 378.83s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 46/20000 [5:25:41<2092:30:56, 377.52s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 47/20000 [5:31:45<2069:56:44, 373.47s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 48/20000 [5:38:02<2076:06:08, 374.60s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 49/20000 [5:44:26<2090:51:20, 377.28s/it]
[debugging] num blocks: 43
{'loss': 0.7261, 'learning_rate': 1e-08, 'epoch': 0.79}

  0%|▎                                                                                                                                | 50/20000 [5:52:02<2221:41:09, 400.91s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 51/20000 [5:57:38<2113:37:52, 381.43s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 52/20000 [6:03:50<2097:41:02, 378.57s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 53/20000 [6:09:11<2002:20:05, 361.38s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 54/20000 [6:15:19<2013:33:37, 363.42s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 55/20000 [6:21:44<2048:12:28, 369.69s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 56/20000 [6:28:06<2069:05:32, 373.48s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 57/20000 [6:34:09<2051:25:32, 370.31s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                | 58/20000 [6:40:15<2044:45:52, 369.13s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 59/20000 [6:45:45<1978:24:20, 357.17s/it]
[debugging] num blocks: 43
{'loss': 0.7031, 'learning_rate': 1e-08, 'epoch': 0.95}

  0%|▍                                                                                                                                | 60/20000 [6:52:17<2037:13:11, 367.80s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 61/20000 [6:57:47<1974:12:10, 356.44s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 62/20000 [7:04:14<2024:24:53, 365.53s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 157040.0049686432, 'epoch': 1.0}

  0%|▍                                                                                                                                | 63/20000 [7:06:51<1677:56:29, 302.98s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 64/20000 [7:12:47<1765:56:39, 318.89s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 65/20000 [7:19:08<1869:26:18, 337.60s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 66/20000 [7:25:11<1911:49:08, 345.27s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 67/20000 [7:31:13<1939:06:36, 350.21s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 68/20000 [7:37:40<1999:53:58, 361.21s/it]
[debugging] num blocks: 43


  0%|▍                                                                                                                                | 70/20000 [7:47:48<1803:45:55, 325.82s/it]
[debugging] num blocks: 43
{'loss': 0.7217, 'learning_rate': 1e-08, 'epoch': 1.11}
{'peak_mem': 48.82130432128906, 'step_consumption': 234435.88161468506, 'epoch': 1.11}
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 71/20000 [7:53:39<1845:55:23, 333.45s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 72/20000 [8:00:19<1956:19:58, 353.41s/it]
[debugging] num blocks: 43


  0%|▍                                                                                                                                | 74/20000 [8:12:40<2000:45:58, 361.48s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 365109.7209453583, 'epoch': 1.17}
[debugging] num blocks: 43

  0%|▍                                                                                                                                | 75/20000 [8:18:47<2010:40:50, 363.28s/it]
[debugging] num blocks: 43


  0%|▍                                                                                                                                | 77/20000 [8:31:59<2116:57:18, 382.52s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 425608.6847782135, 'epoch': 1.22}
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 78/20000 [8:37:22<2018:42:24, 364.79s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 79/20000 [8:43:13<1995:10:10, 360.55s/it]
[debugging] num blocks: 43
{'loss': 0.7338, 'learning_rate': 1e-08, 'epoch': 1.27}

  0%|▌                                                                                                                                | 80/20000 [8:49:37<2035:04:16, 367.78s/it]
[debugging] num blocks: 43


  0%|▌                                                                                                                                | 82/20000 [9:01:54<2033:12:45, 367.48s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 361145.79796791077, 'epoch': 1.3}
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 83/20000 [9:08:08<2043:14:07, 369.32s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 84/20000 [9:13:35<1972:26:08, 356.54s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 85/20000 [9:18:57<1915:30:23, 346.26s/it]
[debugging] num blocks: 43


  0%|▌                                                                                                                                | 87/20000 [9:31:54<2044:40:12, 369.65s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 88/20000 [9:37:33<1993:44:54, 360.46s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 89/20000 [9:43:35<1995:47:04, 360.85s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 361739.2692565918, 'epoch': 1.41}
[debugging] num blocks: 43
{'loss': 0.7326, 'learning_rate': 1e-08, 'epoch': 1.43}

  0%|▌                                                                                                                                | 90/20000 [9:49:26<1980:14:32, 358.05s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                | 91/20000 [9:55:56<2033:11:32, 367.65s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                               | 92/20000 [10:01:51<2011:26:06, 363.73s/it]
[debugging] num blocks: 43


  0%|▌                                                                                                                               | 94/20000 [10:15:39<2137:09:59, 386.51s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                               | 95/20000 [10:21:56<2120:16:23, 383.47s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                               | 96/20000 [10:29:34<2243:28:24, 405.77s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 457800.9383678436, 'epoch': 1.52}
[debugging] num blocks: 43

  0%|▌                                                                                                                               | 97/20000 [10:35:59<2210:08:27, 399.76s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                               | 98/20000 [10:42:12<2164:32:14, 391.54s/it]
[debugging] num blocks: 43


  0%|▋                                                                                                                              | 100/20000 [10:54:03<2068:43:18, 374.24s/it]
[debugging] num blocks: 43
{'loss': 0.7469, 'learning_rate': 1e-08, 'epoch': 1.59}
{'peak_mem': 48.82130432128906, 'step_consumption': 365717.31424331665, 'epoch': 1.59}
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 101/20000 [11:00:01<2040:29:18, 369.15s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 102/20000 [11:06:15<2049:22:50, 370.78s/it]
[debugging] num blocks: 43


  1%|▋                                                                                                                              | 104/20000 [11:17:49<1981:14:24, 358.49s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 105/20000 [11:23:18<1931:26:54, 349.50s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 106/20000 [11:28:58<1915:55:28, 346.70s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 340181.6301345825, 'epoch': 1.68}
[debugging] num blocks: 43


  1%|▋                                                                                                                              | 108/20000 [11:41:14<1965:55:22, 355.79s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 109/20000 [11:47:09<1964:29:35, 355.55s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 110/20000 [11:53:07<1967:50:27, 356.17s/it]
[debugging] num blocks: 43
{'loss': 0.7094, 'learning_rate': 1e-08, 'epoch': 1.75}

  1%|▋                                                                                                                              | 111/20000 [11:58:54<1952:50:58, 353.47s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 112/20000 [12:04:57<1968:35:56, 356.34s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 113/20000 [12:10:47<1957:28:53, 354.35s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 114/20000 [12:17:02<1991:40:19, 360.56s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 115/20000 [12:23:25<2029:00:31, 367.33s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 116/20000 [12:29:41<2043:29:49, 369.98s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 117/20000 [12:34:21<1894:18:49, 342.98s/it]
[debugging] num blocks: 43

  1%|▋                                                                                                                              | 118/20000 [12:40:27<1932:34:11, 349.93s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 119/20000 [12:47:22<2039:08:14, 369.24s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 120/20000 [12:53:40<2054:35:39, 372.06s/it]
[debugging] num blocks: 43
{'loss': 0.7306, 'learning_rate': 1e-08, 'epoch': 1.9}
{'peak_mem': 48.82130432128906, 'step_consumption': 378626.36733055115, 'epoch': 1.9}
[debugging] num blocks: 43


  1%|▊                                                                                                                              | 122/20000 [13:05:16<1990:13:30, 360.44s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 123/20000 [13:11:32<2016:04:16, 365.14s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 124/20000 [13:17:58<2050:11:39, 371.34s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 125/20000 [13:24:36<2094:26:22, 379.37s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 126/20000 [13:28:34<1860:29:07, 337.01s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 238165.04168510437, 'epoch': 2.0}

  1%|▊                                                                                                                              | 127/20000 [13:34:52<1927:51:55, 349.23s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 128/20000 [13:40:59<1957:49:08, 354.68s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 367371.35553359985, 'epoch': 2.03}
[debugging] num blocks: 43


  1%|▊                                                                                                                              | 130/20000 [13:52:22<1916:09:11, 347.16s/it]
[debugging] num blocks: 43
{'loss': 0.7195, 'learning_rate': 1e-08, 'epoch': 2.06}

  1%|▊                                                                                                                              | 131/20000 [13:59:03<2004:20:09, 363.16s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 132/20000 [14:03:59<1893:20:01, 343.06s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 133/20000 [14:08:19<1756:50:40, 318.35s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 134/20000 [14:12:53<1681:51:37, 304.78s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 135/20000 [14:17:42<1656:29:25, 300.19s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 136/20000 [14:22:06<1596:40:12, 289.37s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                              | 137/20000 [14:26:56<1596:43:57, 289.39s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 289446.35677337646, 'epoch': 2.17}
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 138/20000 [14:31:26<1565:03:56, 283.67s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 139/20000 [14:36:10<1565:30:26, 283.76s/it]
[debugging] num blocks: 43
{'loss': 0.7153, 'learning_rate': 1e-08, 'epoch': 2.22}

  1%|▉                                                                                                                              | 140/20000 [14:40:44<1550:14:21, 281.01s/it]

  1%|▉                                                                                                                              | 141/20000 [14:45:44<1581:14:05, 286.64s/it]

  1%|▉                                                                                                                              | 142/20000 [14:51:27<1673:38:11, 303.41s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 342519.09923553467, 'epoch': 2.25}
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 143/20000 [14:56:10<1640:53:21, 297.49s/it]
[debugging] num blocks: 43


  1%|▉                                                                                                                              | 145/20000 [15:05:52<1618:21:43, 293.43s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 283996.58131599426, 'epoch': 2.3}
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 146/20000 [15:11:51<1727:08:29, 313.17s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 147/20000 [15:16:40<1687:29:46, 306.00s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 148/20000 [15:21:06<1619:55:16, 293.76s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 149/20000 [15:26:14<1643:46:17, 298.10s/it]
[debugging] num blocks: 43
{'loss': 0.7401, 'learning_rate': 1e-08, 'epoch': 2.38}

  1%|▉                                                                                                                              | 150/20000 [15:30:39<1588:26:48, 288.08s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 151/20000 [15:35:37<1605:21:36, 291.16s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 152/20000 [15:40:10<1575:40:59, 285.80s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 153/20000 [15:45:15<1607:38:04, 291.60s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 154/20000 [15:50:43<1667:24:50, 302.46s/it]
[debugging] num blocks: 43


  1%|▉                                                                                                                              | 156/20000 [16:00:41<1664:31:51, 301.97s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 313710.489988327, 'epoch': 2.48}
[debugging] num blocks: 43

  1%|▉                                                                                                                              | 157/20000 [16:05:02<1596:46:39, 289.69s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 158/20000 [16:09:46<1586:54:49, 287.92s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 159/20000 [16:14:49<1612:30:29, 292.58s/it]
[debugging] num blocks: 43
{'loss': 0.7106, 'learning_rate': 1e-08, 'epoch': 2.54}

  1%|█                                                                                                                              | 160/20000 [16:19:10<1559:25:13, 282.96s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 161/20000 [16:24:42<1640:13:01, 297.64s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 162/20000 [16:28:59<1573:29:54, 285.54s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 163/20000 [16:34:31<1651:08:53, 299.65s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 164/20000 [16:39:21<1635:10:11, 296.76s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 165/20000 [16:43:58<1601:31:21, 290.67s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 166/20000 [16:48:57<1615:07:54, 293.16s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 167/20000 [16:53:47<1610:20:15, 292.30s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 168/20000 [16:59:57<1738:05:19, 315.51s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 169/20000 [17:04:44<1690:26:11, 306.87s/it]
[debugging] num blocks: 43
{'loss': 0.7331, 'learning_rate': 1e-08, 'epoch': 2.7}

  1%|█                                                                                                                              | 170/20000 [17:09:28<1652:27:31, 299.99s/it]
[debugging] num blocks: 43


  1%|█                                                                                                                              | 172/20000 [17:19:09<1633:11:23, 296.52s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 303634.61661338806, 'epoch': 2.73}
[debugging] num blocks: 43

  1%|█                                                                                                                              | 173/20000 [17:24:15<1647:58:34, 299.22s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 174/20000 [17:29:29<1672:39:22, 303.72s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 175/20000 [17:34:08<1631:27:08, 296.25s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 176/20000 [17:38:54<1615:06:43, 293.30s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                              | 177/20000 [17:44:09<1649:27:06, 299.55s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 178/20000 [17:48:53<1623:49:35, 294.91s/it]
[debugging] num blocks: 43


  1%|█▏                                                                                                                             | 180/20000 [17:58:00<1563:41:31, 284.02s/it]
[debugging] num blocks: 43
{'loss': 0.7133, 'learning_rate': 1e-08, 'epoch': 2.86}

  1%|█▏                                                                                                                             | 181/20000 [18:03:08<1603:37:19, 291.29s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 308236.01722717285, 'epoch': 2.87}
[debugging] num blocks: 43


  1%|█▏                                                                                                                             | 183/20000 [18:12:51<1607:11:02, 291.96s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 184/20000 [18:17:55<1627:26:01, 295.66s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 185/20000 [18:22:39<1608:03:30, 292.15s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 283965.8489227295, 'epoch': 2.94}
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 186/20000 [18:27:13<1577:33:36, 286.63s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 187/20000 [18:31:57<1573:16:16, 285.86s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 188/20000 [18:36:41<1570:06:26, 285.30s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 106705.25169372559, 'epoch': 3.0}


  1%|█▏                                                                                                                             | 190/20000 [18:43:37<1402:56:00, 254.95s/it]
[debugging] num blocks: 43
{'loss': 0.7495, 'learning_rate': 1e-08, 'epoch': 3.02}

  1%|█▏                                                                                                                             | 191/20000 [18:48:03<1422:12:03, 258.46s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 266656.08525276184, 'epoch': 3.03}
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 192/20000 [18:52:25<1427:34:44, 259.46s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 193/20000 [18:56:59<1450:42:20, 263.67s/it]
[debugging] num blocks: 43


  1%|█▏                                                                                                                             | 195/20000 [19:06:38<1528:53:47, 277.91s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                             | 196/20000 [19:11:28<1548:25:12, 281.47s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 289779.15239334106, 'epoch': 3.11}
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 197/20000 [19:17:28<1677:38:16, 304.98s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 198/20000 [19:22:12<1643:06:02, 298.72s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 199/20000 [19:26:46<1602:36:26, 291.37s/it]
[debugging] num blocks: 43
{'loss': 0.7264, 'learning_rate': 1e-08, 'epoch': 3.17}

  1%|█▎                                                                                                                             | 200/20000 [19:31:38<1602:21:21, 291.34s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 201/20000 [19:36:53<1642:33:01, 298.66s/it]
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 203/20000 [19:46:49<1631:35:11, 296.70s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 281217.1652317047, 'epoch': 3.22}
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 205/20000 [19:57:06<1657:50:27, 301.50s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 295306.0870170593, 'epoch': 3.25}
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 207/20000 [20:06:36<1616:18:48, 293.98s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 293680.9227466583, 'epoch': 3.29}
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 208/20000 [20:11:21<1601:47:56, 291.35s/it]
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 210/20000 [20:20:39<1550:59:11, 282.14s/it]
[debugging] num blocks: 43
{'loss': 0.7439, 'learning_rate': 1e-08, 'epoch': 3.33}
{'peak_mem': 48.82130432128906, 'step_consumption': 246780.4570198059, 'epoch': 3.33}
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 211/20000 [20:25:37<1576:14:15, 286.75s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                             | 212/20000 [20:31:15<1660:27:03, 302.08s/it]
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 214/20000 [20:40:50<1620:48:59, 294.90s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 289001.1622905731, 'epoch': 3.4}
[debugging] num blocks: 43


  1%|█▎                                                                                                                             | 216/20000 [20:50:25<1585:23:16, 288.49s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 257861.29713058472, 'epoch': 3.43}
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 217/20000 [20:56:17<1688:40:05, 307.29s/it]
[debugging] num blocks: 43


  1%|█▍                                                                                                                             | 219/20000 [21:06:05<1649:07:00, 300.13s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 220/20000 [21:11:01<1643:06:17, 299.05s/it]
[debugging] num blocks: 43
{'loss': 0.7416, 'learning_rate': 1e-08, 'epoch': 3.49}
{'peak_mem': 48.82130432128906, 'step_consumption': 296523.5140323639, 'epoch': 3.49}
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 221/20000 [21:16:22<1679:26:41, 305.68s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 222/20000 [21:21:29<1680:31:11, 305.89s/it]
[debugging] num blocks: 43


  1%|█▍                                                                                                                             | 224/20000 [21:31:36<1672:29:36, 304.46s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 225/20000 [21:35:41<1573:47:03, 286.50s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 226/20000 [21:41:20<1661:00:38, 302.40s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 227/20000 [21:46:33<1677:47:22, 305.47s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 228/20000 [21:51:45<1689:14:14, 307.57s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 229/20000 [21:58:05<1807:30:50, 329.12s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 379399.0442752838, 'epoch': 3.63}
[debugging] num blocks: 43
{'loss': 0.7, 'learning_rate': 1e-08, 'epoch': 3.65}


  1%|█▍                                                                                                                             | 231/20000 [22:07:31<1668:31:30, 303.84s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 232/20000 [22:12:29<1659:50:18, 302.28s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 298613.6140823364, 'epoch': 3.68}
[debugging] num blocks: 43


  1%|█▍                                                                                                                             | 234/20000 [22:22:10<1617:57:56, 294.68s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 235/20000 [22:26:58<1606:28:50, 292.60s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                             | 236/20000 [22:31:40<1590:03:31, 289.63s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 237/20000 [22:36:20<1573:43:41, 286.67s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 238/20000 [22:41:46<1638:46:07, 298.53s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 239/20000 [22:46:30<1614:05:34, 294.05s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 240/20000 [22:51:37<1636:30:26, 298.15s/it]
[debugging] num blocks: 43
{'loss': 0.7066, 'learning_rate': 1e-08, 'epoch': 3.81}

  1%|█▌                                                                                                                             | 241/20000 [22:56:38<1639:45:40, 298.76s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 300166.0122871399, 'epoch': 3.83}
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 242/20000 [23:01:37<1641:13:44, 299.04s/it]
[debugging] num blocks: 43


  1%|█▌                                                                                                                             | 244/20000 [23:11:17<1614:56:02, 294.28s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 289404.9072265625, 'epoch': 3.87}
[debugging] num blocks: 43


  1%|█▌                                                                                                                             | 246/20000 [23:20:32<1563:42:07, 284.97s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 247/20000 [23:25:46<1612:15:43, 293.84s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 248/20000 [23:30:07<1556:59:02, 283.78s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 249/20000 [23:35:20<1605:40:18, 292.66s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 250/20000 [23:40:08<1597:19:35, 291.16s/it]
[debugging] num blocks: 43
{'loss': 0.7341, 'learning_rate': 1e-08, 'epoch': 3.97}

  1%|█▌                                                                                                                             | 251/20000 [23:44:36<1559:07:17, 284.21s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 252/20000 [23:46:58<1325:01:07, 241.55s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 141987.8318309784, 'epoch': 4.0}

  1%|█▌                                                                                                                             | 253/20000 [23:51:41<1393:17:19, 254.01s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 254/20000 [23:57:03<1505:40:50, 274.51s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                             | 255/20000 [24:01:12<1463:32:50, 266.84s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 256/20000 [24:06:13<1519:02:51, 276.97s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 300609.73930358887, 'epoch': 4.06}
[debugging] num blocks: 43


  1%|█▋                                                                                                                             | 258/20000 [24:16:25<1603:18:19, 292.37s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 259/20000 [24:20:48<1556:13:05, 283.79s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 260/20000 [24:25:32<1555:24:55, 283.66s/it]
[debugging] num blocks: 43
{'loss': 0.7409, 'learning_rate': 1e-08, 'epoch': 4.13}

  1%|█▋                                                                                                                             | 261/20000 [24:30:20<1563:47:46, 285.21s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 262/20000 [24:36:14<1676:19:31, 305.74s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 353657.4902534485, 'epoch': 4.16}
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 263/20000 [24:41:20<1676:02:06, 305.71s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 264/20000 [24:46:34<1689:44:26, 308.22s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 265/20000 [24:51:04<1626:26:50, 296.69s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 266/20000 [24:56:01<1627:58:56, 296.99s/it]

  1%|█▋                                                                                                                             | 267/20000 [25:00:41<1599:17:29, 291.77s/it]
{'peak_mem': 48.82130432128906, 'step_consumption': 279581.3591480255, 'epoch': 4.24}
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 268/20000 [25:06:21<1678:49:36, 306.29s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 269/20000 [25:10:50<1617:55:56, 295.20s/it]
[debugging] num blocks: 43
{'loss': 0.6935, 'learning_rate': 1e-08, 'epoch': 4.29}

  1%|█▋                                                                                                                             | 270/20000 [25:15:41<1610:18:03, 293.82s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 271/20000 [25:27:11<2261:32:40, 412.67s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 272/20000 [25:36:27<2496:45:15, 455.61s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 273/20000 [25:45:44<2664:18:57, 486.21s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 274/20000 [25:55:09<2793:45:04, 509.86s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                             | 275/20000 [26:02:32<2682:33:52, 489.59s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 276/20000 [26:11:30<2762:38:06, 504.23s/it]
[debugging] num blocks: 43


  1%|█▊                                                                                                                             | 278/20000 [26:28:41<2803:36:47, 511.76s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 535815.4501914978, 'epoch': 4.41}
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 279/20000 [26:38:04<2888:19:42, 527.25s/it]
[debugging] num blocks: 43
{'loss': 0.7399, 'learning_rate': 1e-08, 'epoch': 4.44}

  1%|█▊                                                                                                                             | 280/20000 [26:46:49<2883:46:47, 526.45s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 281/20000 [26:56:20<2956:48:35, 539.81s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 282/20000 [27:05:20<2956:26:38, 539.77s/it]

  1%|█▊                                                                                                                             | 283/20000 [27:13:50<2908:35:49, 531.06s/it]
{'peak_mem': 48.82130432128906, 'step_consumption': 510734.1823577881, 'epoch': 4.49}
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 284/20000 [27:21:15<2765:48:59, 505.02s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 285/20000 [27:28:09<2617:03:32, 477.88s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 286/20000 [27:32:11<2228:32:43, 406.96s/it]
[debugging] num blocks: 43


  1%|█▊                                                                                                                             | 288/20000 [27:43:37<2032:11:13, 371.14s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 306093.83511543274, 'epoch': 4.57}
[debugging] num blocks: 43


  1%|█▊                                                                                                                             | 290/20000 [27:53:16<1807:53:58, 330.21s/it]
[debugging] num blocks: 43
{'loss': 0.7387, 'learning_rate': 1e-08, 'epoch': 4.6}

  1%|█▊                                                                                                                             | 291/20000 [27:58:29<1780:20:05, 325.19s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 313472.7210998535, 'epoch': 4.62}
[debugging] num blocks: 43


  1%|█▊                                                                                                                             | 293/20000 [28:09:05<1771:22:37, 323.59s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 343082.8859806061, 'epoch': 4.65}
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 294/20000 [28:14:33<1780:01:08, 325.18s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                             | 295/20000 [28:20:28<1828:24:46, 334.04s/it]
[debugging] num blocks: 43


  1%|█▉                                                                                                                             | 297/20000 [28:30:14<1717:33:04, 313.82s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                             | 298/20000 [28:34:42<1642:15:21, 300.08s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 268003.87263298035, 'epoch': 4.73}
[debugging] num blocks: 43


  2%|█▉                                                                                                                             | 300/20000 [28:45:07<1694:21:29, 309.63s/it]
[debugging] num blocks: 43
{'loss': 0.7361, 'learning_rate': 1e-08, 'epoch': 4.76}
{'peak_mem': 48.82130432128906, 'step_consumption': 348985.23020744324, 'epoch': 4.76}
[debugging] num blocks: 43


  2%|█▉                                                                                                                             | 302/20000 [28:55:18<1677:17:04, 306.54s/it]
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 303/20000 [28:59:42<1607:16:47, 293.76s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 263931.21242523193, 'epoch': 4.81}
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 304/20000 [29:04:43<1619:16:02, 295.97s/it]
[debugging] num blocks: 43


  2%|█▉                                                                                                                             | 306/20000 [29:14:13<1593:03:02, 291.20s/it]
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 307/20000 [29:19:43<1658:03:53, 303.10s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 330861.62543296814, 'epoch': 4.87}
[debugging] num blocks: 43


  2%|█▉                                                                                                                             | 309/20000 [29:28:54<1588:16:29, 290.38s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 292623.2280731201, 'epoch': 4.9}
[debugging] num blocks: 43
{'loss': 0.7186, 'learning_rate': 1e-08, 'epoch': 4.92}


  2%|█▉                                                                                                                             | 311/20000 [29:40:02<1693:25:37, 309.63s/it]
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 312/20000 [29:45:24<1714:04:42, 313.42s/it]
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 313/20000 [29:50:48<1730:18:04, 316.41s/it]
[debugging] num blocks: 43

  2%|█▉                                                                                                                             | 314/20000 [29:55:23<1663:13:33, 304.16s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 275564.48435783386, 'epoch': 4.98}
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 145337.22066879272, 'epoch': 5.0}


  2%|██                                                                                                                             | 316/20000 [30:02:26<1437:07:25, 262.84s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 317/20000 [30:07:18<1484:08:03, 271.45s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 318/20000 [30:11:59<1499:27:53, 274.26s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 280831.46047592163, 'epoch': 5.05}
[debugging] num blocks: 43


  2%|██                                                                                                                             | 320/20000 [30:23:18<1694:39:28, 310.00s/it]
[debugging] num blocks: 43
{'loss': 0.7418, 'learning_rate': 1e-08, 'epoch': 5.08}

  2%|██                                                                                                                             | 321/20000 [30:28:05<1656:43:33, 303.08s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 322/20000 [30:33:13<1664:25:58, 304.50s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 323/20000 [30:38:08<1649:17:26, 301.75s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 295307.29961395264, 'epoch': 5.13}
[debugging] num blocks: 43


  2%|██                                                                                                                             | 325/20000 [30:48:41<1676:25:17, 306.74s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 326/20000 [30:53:05<1606:23:20, 293.94s/it]
[debugging] num blocks: 43

  2%|██                                                                                                                             | 327/20000 [30:57:18<1538:02:35, 281.45s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 252293.5287952423, 'epoch': 5.19}
[debugging] num blocks: 43


  2%|██                                                                                                                             | 329/20000 [31:06:52<1553:39:04, 284.33s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 287116.60718917847, 'epoch': 5.22}
[debugging] num blocks: 43
{'loss': 0.7126, 'learning_rate': 1e-08, 'epoch': 5.24}

  2%|██                                                                                                                             | 330/20000 [31:11:38<1556:28:16, 284.87s/it]Traceback (most recent call last):
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 726, in <module>
    main()
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 678, in main
    framework.train(train_samples, dev_samples if dev_samples is not None else eval_samples, eval_samples)
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 563, in train
    trainer.train(resume_from_checkpoint=last_checkpoint)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/trainer.py", line 1662, in train
    return inner_training_loop(
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 497, in _inner_training_loop
    tr_loss_step = self.zo_step_with_module_wise_perturbation_coordinate(model, inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 882, in zo_step_with_module_wise_perturbation_coordinate
    loss1 = self.zo_forward(model, inputs)
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 747, in zo_forward
    loss = self.compute_loss(model, inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/trainer.py", line 2731, in compute_loss
    outputs = model(**inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/rinya/ZO-LLM-main/zo-bench/utils.py", line 103, in forward_wrap_with_option_len
    if any([x != num_options[0] for x in num_options]):
KeyboardInterrupt