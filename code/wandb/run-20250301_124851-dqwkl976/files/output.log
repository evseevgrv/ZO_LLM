/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/datasets/load.py:1486: FutureWarning: The repository for super_glue contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/super_glue
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Downloading builder script: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30.7k/30.7k [00:00<00:00, 35.6MB/s]
Downloading readme: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18.2k/18.2k [00:00<00:00, 34.8MB/s]
Downloading data: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.12M/1.12M [00:00<00:00, 10.7MB/s]
Generating train split: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27243/27243 [00:01<00:00, 21035.29 examples/s]
Generating validation split: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4848/4848 [00:00<00:00, 21392.26 examples/s]
Generating test split: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9693/9693 [00:00<00:00, 22734.65 examples/s]
2025-03-01 12:49:00,842 - INFO - Sample train set 1500/27243
2025-03-01 12:49:00,843 - INFO - ... including dev set 500 samples
2025-03-01 12:49:00,843 - INFO - Loading model with FP16...
/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
78



Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [02:25<00:00, 48.34s/it]
2025-03-01 12:51:27,563 - INFO - Done with 146.72s
2025-03-01 12:51:27,925 - INFO - Inject lora to: model.decoder.layers.0.self_attn
2025-03-01 12:51:28,717 - INFO - Inject lora to: model.decoder.layers.1.self_attn
2025-03-01 12:51:29,425 - INFO - Inject lora to: model.decoder.layers.2.self_attn
2025-03-01 12:51:30,156 - INFO - Inject lora to: model.decoder.layers.3.self_attn
2025-03-01 12:51:30,893 - INFO - Inject lora to: model.decoder.layers.4.self_attn
2025-03-01 12:51:31,604 - INFO - Inject lora to: model.decoder.layers.5.self_attn
2025-03-01 12:51:32,326 - INFO - Inject lora to: model.decoder.layers.6.self_attn
2025-03-01 12:51:33,056 - INFO - Inject lora to: model.decoder.layers.7.self_attn
2025-03-01 12:51:33,784 - INFO - Inject lora to: model.decoder.layers.8.self_attn
2025-03-01 12:51:34,540 - INFO - Inject lora to: model.decoder.layers.9.self_attn
2025-03-01 12:51:35,273 - INFO - Inject lora to: model.decoder.layers.10.self_attn
2025-03-01 12:51:36,014 - INFO - Inject lora to: model.decoder.layers.11.self_attn
2025-03-01 12:51:36,764 - INFO - Inject lora to: model.decoder.layers.12.self_attn
2025-03-01 12:51:37,497 - INFO - Inject lora to: model.decoder.layers.13.self_attn
2025-03-01 12:51:38,241 - INFO - Inject lora to: model.decoder.layers.14.self_attn
2025-03-01 12:51:38,955 - INFO - Inject lora to: model.decoder.layers.15.self_attn
2025-03-01 12:51:39,676 - INFO - Inject lora to: model.decoder.layers.16.self_attn
2025-03-01 12:51:40,387 - INFO - Inject lora to: model.decoder.layers.17.self_attn
2025-03-01 12:51:41,107 - INFO - Inject lora to: model.decoder.layers.18.self_attn
2025-03-01 12:51:41,827 - INFO - Inject lora to: model.decoder.layers.19.self_attn
2025-03-01 12:51:42,542 - INFO - Inject lora to: model.decoder.layers.20.self_attn
2025-03-01 12:51:43,299 - INFO - Inject lora to: model.decoder.layers.21.self_attn
2025-03-01 12:51:44,020 - INFO - Inject lora to: model.decoder.layers.22.self_attn
2025-03-01 12:51:44,748 - INFO - Inject lora to: model.decoder.layers.23.self_attn
2025-03-01 12:51:45,469 - INFO - Inject lora to: model.decoder.layers.24.self_attn
2025-03-01 12:51:46,210 - INFO - Inject lora to: model.decoder.layers.25.self_attn
2025-03-01 12:51:46,966 - INFO - Inject lora to: model.decoder.layers.26.self_attn
2025-03-01 12:51:47,697 - INFO - Inject lora to: model.decoder.layers.27.self_attn
2025-03-01 12:51:48,460 - INFO - Inject lora to: model.decoder.layers.28.self_attn
2025-03-01 12:51:49,179 - INFO - Inject lora to: model.decoder.layers.29.self_attn
2025-03-01 12:51:49,918 - INFO - Inject lora to: model.decoder.layers.30.self_attn
2025-03-01 12:51:50,653 - INFO - Inject lora to: model.decoder.layers.31.self_attn
2025-03-01 12:51:51,401 - INFO - Inject lora to: model.decoder.layers.32.self_attn
2025-03-01 12:51:52,146 - INFO - Inject lora to: model.decoder.layers.33.self_attn
2025-03-01 12:51:52,884 - INFO - Inject lora to: model.decoder.layers.34.self_attn
2025-03-01 12:51:53,650 - INFO - Inject lora to: model.decoder.layers.35.self_attn
2025-03-01 12:51:54,368 - INFO - Inject lora to: model.decoder.layers.36.self_attn
2025-03-01 12:51:55,074 - INFO - Inject lora to: model.decoder.layers.37.self_attn
2025-03-01 12:51:55,807 - INFO - Inject lora to: model.decoder.layers.38.self_attn
2025-03-01 12:51:56,543 - INFO - Inject lora to: model.decoder.layers.39.self_attn
2025-03-01 12:51:57,279 - INFO - Dev samples: 500
2025-03-01 12:51:57,279 - INFO - Train samples: 1000
2025-03-01 12:51:57,279 - INFO - Eval sample length is 1000
2025-03-01 12:51:57,279 - INFO - Tokenizing training samples...
### layer-wise gradient sparsity = None
-------------------------- Training Epoch 0 --------------------------
2025-03-01 12:52:08,243 - INFO - Done with 10.96s
/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
2025-03-01 12:52:08,266 - INFO - ***** Running training *****
2025-03-01 12:52:08,266 - INFO -   Num examples = 1000
2025-03-01 12:52:08,266 - INFO -   Num Epochs = 318
2025-03-01 12:52:08,266 - INFO -   Instantaneous batch size per device = 16
2025-03-01 12:52:08,267 - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 16
2025-03-01 12:52:08,267 - INFO -   Gradient Accumulation steps = 1
2025-03-01 12:52:08,267 - INFO -   Total optimization steps = 20000
2025-03-01 12:52:08,268 - INFO -   Number of trainable parameters = 6553600
  0%|                                                                                                                                                                 | 0/20000 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 293894.2506313324, 'epoch': 0.02}

  0%|                                                                                                                                                   | 2/20000 [08:49<1442:58:42, 259.76s/it]
[debugging] num blocks: 43
{'peak_mem': 44.54669523239136, 'step_consumption': 235850.5344390869, 'epoch': 0.03}
[debugging] num blocks: 43

  0%|                                                                                                                                                   | 3/20000 [13:14<1456:29:52, 262.21s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                   | 4/20000 [17:52<1491:00:05, 268.43s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                   | 5/20000 [22:31<1511:00:36, 272.05s/it]
[debugging] num blocks: 43


  0%|                                                                                                                                                   | 7/20000 [31:59<1547:56:40, 278.73s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                   | 8/20000 [37:05<1596:43:35, 287.53s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                   | 9/20000 [41:50<1591:02:49, 286.52s/it]
[debugging] num blocks: 43
{'peak_mem': 45.079598903656006, 'step_consumption': 284291.5229797363, 'epoch': 0.14}
[debugging] num blocks: 43
{'loss': 0.7201, 'learning_rate': 1e-08, 'epoch': 0.16}

  0%|                                                                                                                                                  | 10/20000 [47:00<1632:41:51, 294.03s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                  | 11/20000 [51:45<1615:38:26, 290.98s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                  | 12/20000 [56:39<1621:00:00, 291.96s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                | 13/20000 [1:01:12<1589:19:40, 286.27s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                | 14/20000 [1:05:40<1558:00:40, 280.64s/it]
[debugging] num blocks: 43

  0%|                                                                                                                                                | 15/20000 [1:10:32<1578:07:36, 284.28s/it]
[debugging] num blocks: 43


  0%|                                                                                                                                                | 17/20000 [1:20:44<1649:21:10, 297.14s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 18/20000 [1:25:28<1627:46:49, 293.26s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 284243.22390556335, 'epoch': 0.29}
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 19/20000 [1:30:08<1605:32:42, 289.27s/it]

  0%|▏                                                                                                                                               | 20/20000 [1:35:10<1627:47:51, 293.30s/it]
{'loss': 0.7102, 'learning_rate': 1e-08, 'epoch': 0.32}

  0%|▏                                                                                                                                               | 21/20000 [1:40:03<1625:45:48, 292.95s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 22/20000 [1:45:01<1634:37:50, 294.56s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 298309.1244697571, 'epoch': 0.35}
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 23/20000 [1:49:45<1616:54:50, 291.38s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 24/20000 [1:54:21<1591:27:52, 286.81s/it]
[debugging] num blocks: 43


  0%|▏                                                                                                                                               | 26/20000 [2:03:57<1596:01:31, 287.66s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 27/20000 [2:08:41<1589:51:43, 286.56s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 283995.6045150757, 'epoch': 0.43}
[debugging] num blocks: 43


  0%|▏                                                                                                                                               | 29/20000 [2:17:48<1548:02:54, 279.05s/it]
[debugging] num blocks: 43

  0%|▏                                                                                                                                               | 30/20000 [2:22:52<1589:31:56, 286.55s/it]
[debugging] num blocks: 43
{'loss': 0.725, 'learning_rate': 1e-08, 'epoch': 0.48}

  0%|▏                                                                                                                                               | 31/20000 [2:27:39<1589:30:25, 286.56s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 286558.1920146942, 'epoch': 0.49}
[debugging] num blocks: 43


  0%|▏                                                                                                                                               | 33/20000 [2:36:42<1550:22:15, 279.53s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 276858.08539390564, 'epoch': 0.52}
[debugging] num blocks: 43


  0%|▎                                                                                                                                               | 35/20000 [2:46:19<1580:09:47, 284.93s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 36/20000 [2:50:51<1557:51:10, 280.92s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 37/20000 [2:54:58<1500:57:39, 270.67s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 38/20000 [2:59:38<1517:00:28, 273.58s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 39/20000 [3:04:00<1497:40:33, 270.11s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 40/20000 [3:08:17<1475:44:50, 266.17s/it]
[debugging] num blocks: 43
{'loss': 0.7614, 'learning_rate': 1e-08, 'epoch': 0.63}

  0%|▎                                                                                                                                               | 41/20000 [3:12:39<1468:21:19, 264.85s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 42/20000 [3:18:16<1588:21:13, 286.51s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 43/20000 [3:23:16<1610:26:49, 290.51s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 44/20000 [3:27:06<1510:56:37, 272.57s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 45/20000 [3:33:02<1648:59:15, 297.49s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 355618.25919151306, 'epoch': 0.71}
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 46/20000 [3:37:56<1642:29:54, 296.33s/it]
[debugging] num blocks: 43


  0%|▎                                                                                                                                               | 48/20000 [3:47:41<1636:14:45, 295.23s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 49/20000 [3:52:50<1658:58:55, 299.35s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 308947.9019641876, 'epoch': 0.78}
[debugging] num blocks: 43
{'loss': 0.7261, 'learning_rate': 1e-08, 'epoch': 0.79}


  0%|▎                                                                                                                                               | 51/20000 [4:03:18<1677:52:06, 302.79s/it]
[debugging] num blocks: 43

  0%|▎                                                                                                                                               | 52/20000 [4:08:10<1658:40:26, 299.34s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 53/20000 [4:12:23<1581:50:57, 285.49s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 54/20000 [4:17:07<1579:18:31, 285.05s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 55/20000 [4:21:51<1577:37:57, 284.76s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 56/20000 [4:26:50<1600:36:18, 288.92s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 57/20000 [4:31:34<1592:23:27, 287.45s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 58/20000 [4:36:19<1587:55:53, 286.66s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 59/20000 [4:40:42<1550:01:14, 279.83s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 60/20000 [4:45:48<1592:56:27, 287.59s/it]
[debugging] num blocks: 43
{'loss': 0.7031, 'learning_rate': 1e-08, 'epoch': 0.95}

  0%|▍                                                                                                                                               | 61/20000 [4:50:06<1542:46:55, 278.55s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 62/20000 [4:55:07<1579:59:14, 285.28s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 63/20000 [4:57:07<1305:51:29, 235.80s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 120327.34370231628, 'epoch': 1.0}

  0%|▍                                                                                                                                               | 64/20000 [5:01:44<1374:25:56, 248.19s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 65/20000 [5:06:42<1456:54:12, 263.10s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 66/20000 [5:11:26<1491:34:05, 269.37s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 67/20000 [5:16:10<1515:41:30, 273.74s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 283930.91797828674, 'epoch': 1.06}
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 68/20000 [5:21:16<1569:25:38, 283.46s/it]
[debugging] num blocks: 43

  0%|▍                                                                                                                                               | 69/20000 [5:26:09<1585:23:43, 286.36s/it]
[debugging] num blocks: 43
{'loss': 0.7217, 'learning_rate': 1e-08, 'epoch': 1.11}

  0%|▌                                                                                                                                               | 70/20000 [5:29:07<1405:15:40, 253.84s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 71/20000 [5:33:34<1426:10:05, 257.62s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 72/20000 [5:38:34<1497:35:46, 270.54s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 73/20000 [5:43:25<1531:49:32, 276.74s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 74/20000 [5:48:09<1543:49:02, 278.92s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 75/20000 [5:52:53<1552:06:58, 280.43s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 76/20000 [5:57:37<1558:01:46, 281.52s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 77/20000 [6:03:14<1648:40:01, 297.91s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 78/20000 [6:07:23<1568:23:45, 283.42s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 79/20000 [6:11:59<1556:13:00, 281.23s/it]
[debugging] num blocks: 43
{'loss': 0.7338, 'learning_rate': 1e-08, 'epoch': 1.27}

  0%|▌                                                                                                                                               | 80/20000 [6:17:00<1588:16:06, 287.04s/it]
[debugging] num blocks: 43


  0%|▌                                                                                                                                               | 82/20000 [6:26:35<1588:17:31, 287.07s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 83/20000 [6:31:26<1593:54:16, 288.10s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 290490.60702323914, 'epoch': 1.32}
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 84/20000 [6:35:41<1538:32:21, 278.11s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 85/20000 [6:39:51<1492:27:54, 269.79s/it]
[debugging] num blocks: 43

  0%|▌                                                                                                                                               | 86/20000 [6:44:35<1515:52:33, 274.04s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 87/20000 [6:49:33<1555:42:32, 281.25s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 88/20000 [6:53:58<1528:45:25, 276.39s/it]
[debugging] num blocks: 43


  0%|▋                                                                                                                                               | 90/20000 [7:03:19<1538:48:52, 278.24s/it]
[debugging] num blocks: 43
{'loss': 0.7326, 'learning_rate': 1e-08, 'epoch': 1.43}
{'peak_mem': 48.82130432128906, 'step_consumption': 277210.200548172, 'epoch': 1.43}
[debugging] num blocks: 43


  0%|▋                                                                                                                                               | 92/20000 [7:13:02<1568:41:24, 283.67s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 276841.370344162, 'epoch': 1.46}
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 93/20000 [7:18:56<1684:34:08, 304.64s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 94/20000 [7:23:52<1671:08:34, 302.23s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 95/20000 [7:28:44<1653:59:51, 299.14s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 96/20000 [7:34:44<1754:35:04, 317.35s/it]
[debugging] num blocks: 43

  0%|▋                                                                                                                                               | 97/20000 [7:39:47<1730:21:17, 312.98s/it]
[debugging] num blocks: 43


  0%|▋                                                                                                                                               | 99/20000 [7:49:30<1664:45:26, 301.15s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 281678.31206321716, 'epoch': 1.57}
[debugging] num blocks: 43
{'loss': 0.7469, 'learning_rate': 1e-08, 'epoch': 1.59}


  1%|▋                                                                                                                                              | 101/20000 [7:59:17<1640:37:47, 296.81s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 288775.33769607544, 'epoch': 1.6}
[debugging] num blocks: 43

  1%|▋                                                                                                                                              | 102/20000 [8:04:02<1621:25:30, 293.35s/it]
[debugging] num blocks: 43


  1%|▋                                                                                                                                              | 104/20000 [8:13:27<1589:46:56, 287.66s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 280794.21186447144, 'epoch': 1.65}
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 105/20000 [8:17:57<1559:43:00, 282.23s/it]
[debugging] num blocks: 43


  1%|▊                                                                                                                                              | 107/20000 [8:27:48<1607:41:59, 290.94s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 315560.2798461914, 'epoch': 1.7}
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 108/20000 [8:32:30<1591:36:27, 288.04s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 109/20000 [8:37:14<1585:07:15, 286.89s/it]
[debugging] num blocks: 43
{'loss': 0.7094, 'learning_rate': 1e-08, 'epoch': 1.75}

  1%|▊                                                                                                                                              | 110/20000 [8:42:03<1588:19:25, 287.48s/it]
[debugging] num blocks: 43


  1%|▊                                                                                                                                              | 112/20000 [8:51:40<1593:26:37, 288.44s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 113/20000 [8:56:24<1586:29:56, 287.19s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 284284.54208374023, 'epoch': 1.79}
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 114/20000 [9:01:29<1615:15:51, 292.41s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 115/20000 [9:06:27<1624:46:34, 294.15s/it]
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 116/20000 [9:11:18<1620:07:38, 293.32s/it]
[debugging] num blocks: 43


  1%|▊                                                                                                                                              | 118/20000 [9:19:23<1491:44:19, 270.11s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 272516.8659687042, 'epoch': 1.87}
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 119/20000 [9:24:53<1590:09:34, 287.94s/it]
[debugging] num blocks: 43
{'loss': 0.7306, 'learning_rate': 1e-08, 'epoch': 1.9}


  1%|▊                                                                                                                                              | 121/20000 [9:34:10<1556:46:49, 281.93s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 263831.3856124878, 'epoch': 1.92}
[debugging] num blocks: 43

  1%|▊                                                                                                                                              | 122/20000 [9:38:48<1549:14:47, 280.58s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                              | 123/20000 [9:43:32<1554:52:34, 281.61s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                              | 124/20000 [9:48:30<1581:36:30, 286.47s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                              | 125/20000 [9:53:40<1621:33:38, 293.72s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 188001.06739997864, 'epoch': 2.0}

  1%|▉                                                                                                                                              | 126/20000 [9:56:48<1446:24:27, 262.00s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 127/20000 [10:01:55<1519:51:30, 275.32s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 128/20000 [10:06:55<1560:38:59, 282.73s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 129/20000 [10:11:39<1563:46:49, 283.31s/it]
[debugging] num blocks: 43
{'loss': 0.7195, 'learning_rate': 1e-08, 'epoch': 2.06}


  1%|▉                                                                                                                                             | 131/20000 [10:21:20<1596:08:52, 289.20s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 314689.63861465454, 'epoch': 2.08}
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 132/20000 [10:26:18<1610:02:27, 291.73s/it]
[debugging] num blocks: 43


  1%|▉                                                                                                                                             | 134/20000 [10:35:27<1565:00:50, 283.60s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 135/20000 [10:40:26<1589:30:41, 288.06s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 136/20000 [10:44:56<1560:32:37, 282.82s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 270596.72713279724, 'epoch': 2.16}
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 137/20000 [10:49:53<1583:22:27, 286.97s/it]
[debugging] num blocks: 43

  1%|▉                                                                                                                                             | 138/20000 [10:54:32<1570:15:30, 284.61s/it]
[debugging] num blocks: 43


  1%|▉                                                                                                                                             | 140/20000 [11:04:08<1576:43:28, 285.81s/it]
[debugging] num blocks: 43
{'loss': 0.7153, 'learning_rate': 1e-08, 'epoch': 2.22}
{'peak_mem': 48.82130432128906, 'step_consumption': 283564.4226074219, 'epoch': 2.22}
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 141/20000 [11:09:14<1611:07:16, 292.06s/it]
[debugging] num blocks: 43


  1%|█                                                                                                                                             | 143/20000 [11:19:54<1672:34:40, 303.23s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 286708.5905075073, 'epoch': 2.27}
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 144/20000 [11:25:01<1678:56:19, 304.40s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 145/20000 [11:29:49<1652:31:05, 299.63s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 146/20000 [11:35:56<1763:53:14, 319.83s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 147/20000 [11:40:54<1727:05:10, 313.18s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 148/20000 [11:45:27<1660:01:31, 301.03s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 149/20000 [11:50:43<1684:32:35, 305.49s/it]
[debugging] num blocks: 43
{'loss': 0.7401, 'learning_rate': 1e-08, 'epoch': 2.38}


  1%|█                                                                                                                                             | 151/20000 [12:00:22<1649:24:27, 299.15s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 307978.33371162415, 'epoch': 2.4}
[debugging] num blocks: 43


  1%|█                                                                                                                                             | 153/20000 [12:10:17<1651:52:58, 299.63s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 313310.25648117065, 'epoch': 2.43}
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 154/20000 [12:15:12<1644:46:47, 298.36s/it]
[debugging] num blocks: 43


  1%|█                                                                                                                                             | 156/20000 [12:24:54<1638:16:21, 297.21s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 157/20000 [12:29:24<1592:32:38, 288.93s/it]
[debugging] num blocks: 43

  1%|█                                                                                                                                             | 158/20000 [12:34:11<1589:20:33, 288.36s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 287028.73158454895, 'epoch': 2.51}
[debugging] num blocks: 43


  1%|█▏                                                                                                                                            | 160/20000 [12:43:51<1583:25:41, 287.32s/it]
[debugging] num blocks: 43
{'loss': 0.7106, 'learning_rate': 1e-08, 'epoch': 2.54}
{'peak_mem': 48.82130432128906, 'step_consumption': 269064.8944377899, 'epoch': 2.54}
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 161/20000 [12:49:30<1669:57:10, 303.03s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 162/20000 [12:53:54<1604:49:04, 291.23s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 163/20000 [12:59:34<1685:33:16, 305.89s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 164/20000 [13:04:33<1674:06:05, 303.83s/it]
[debugging] num blocks: 43


  1%|█▏                                                                                                                                            | 166/20000 [13:14:23<1655:12:38, 300.43s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 167/20000 [13:19:23<1654:03:38, 300.24s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 299777.6999473572, 'epoch': 2.65}
[debugging] num blocks: 43


  1%|█▏                                                                                                                                            | 169/20000 [13:30:35<1734:51:09, 314.93s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 295318.6421394348, 'epoch': 2.68}
[debugging] num blocks: 43
{'loss': 0.7331, 'learning_rate': 1e-08, 'epoch': 2.7}


  1%|█▏                                                                                                                                            | 171/20000 [13:40:08<1653:22:29, 300.17s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 172/20000 [13:45:19<1670:00:25, 303.21s/it]
[debugging] num blocks: 43

  1%|█▏                                                                                                                                            | 173/20000 [13:50:30<1683:21:04, 305.65s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 311327.53920555115, 'epoch': 2.75}
[debugging] num blocks: 43


  1%|█▏                                                                                                                                            | 175/20000 [14:00:33<1663:17:42, 302.04s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 283609.12680625916, 'epoch': 2.78}
[debugging] num blocks: 43


  1%|█▎                                                                                                                                            | 177/20000 [14:10:50<1687:01:33, 306.38s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 178/20000 [14:15:38<1656:53:51, 300.92s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 179/20000 [14:20:19<1624:30:47, 295.05s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 281355.9739589691, 'epoch': 2.84}
[debugging] num blocks: 43
{'loss': 0.7133, 'learning_rate': 1e-08, 'epoch': 2.86}


  1%|█▎                                                                                                                                            | 181/20000 [14:30:17<1643:30:09, 298.53s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 182/20000 [14:35:04<1624:51:26, 295.16s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 183/20000 [14:40:12<1645:03:42, 298.85s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 307435.9450340271, 'epoch': 2.9}
[debugging] num blocks: 43


  1%|█▎                                                                                                                                            | 185/20000 [14:50:12<1642:17:40, 298.37s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 186/20000 [14:54:54<1614:56:22, 293.42s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 187/20000 [14:59:44<1608:34:09, 292.28s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 188/20000 [15:04:31<1600:19:10, 290.79s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 189/20000 [15:06:19<1298:18:05, 235.92s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 107895.51091194153, 'epoch': 3.0}
-------------------------- Training Epoch 3 --------------------------
[debugging] num blocks: 43
{'loss': 0.7495, 'learning_rate': 1e-08, 'epoch': 3.02}

  1%|█▎                                                                                                                                            | 190/20000 [15:11:36<1432:12:53, 260.27s/it]
[debugging] num blocks: 43


  1%|█▎                                                                                                                                            | 192/20000 [15:20:40<1463:36:08, 266.00s/it]
[debugging] num blocks: 43

  1%|█▎                                                                                                                                            | 193/20000 [15:25:21<1489:02:13, 270.64s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 194/20000 [15:30:08<1515:02:58, 275.38s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 195/20000 [15:35:15<1567:11:37, 284.87s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 196/20000 [15:40:12<1587:20:18, 288.55s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 197/20000 [15:46:20<1717:55:37, 312.30s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 198/20000 [15:51:09<1680:56:17, 305.59s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 199/20000 [15:55:51<1641:26:15, 298.43s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 200/20000 [16:00:50<1641:25:26, 298.44s/it]
[debugging] num blocks: 43
{'loss': 0.7264, 'learning_rate': 1e-08, 'epoch': 3.17}

  1%|█▍                                                                                                                                            | 201/20000 [16:06:14<1683:39:38, 306.14s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 202/20000 [16:11:29<1699:26:32, 309.02s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 203/20000 [16:16:11<1653:36:50, 300.70s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 204/20000 [16:21:33<1688:46:47, 307.11s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 205/20000 [16:26:29<1671:09:30, 303.92s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 206/20000 [16:31:05<1625:09:40, 295.57s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 207/20000 [16:36:01<1625:15:27, 295.61s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 208/20000 [16:40:48<1611:25:05, 293.10s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 209/20000 [16:45:59<1640:53:11, 298.48s/it]
[debugging] num blocks: 43

  1%|█▍                                                                                                                                            | 210/20000 [16:50:09<1560:20:04, 283.84s/it]
[debugging] num blocks: 43
{'loss': 0.7439, 'learning_rate': 1e-08, 'epoch': 3.33}

  1%|█▍                                                                                                                                            | 211/20000 [16:55:08<1585:24:05, 288.42s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 212/20000 [17:00:45<1665:47:21, 303.05s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 337203.20105552673, 'epoch': 3.37}
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 213/20000 [17:05:34<1642:22:59, 298.81s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 214/20000 [17:10:23<1625:16:52, 295.71s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 215/20000 [17:15:38<1657:19:18, 301.56s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 216/20000 [17:19:58<1588:16:36, 289.01s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 217/20000 [17:26:50<1792:07:47, 326.12s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 218/20000 [17:34:24<2002:12:11, 364.37s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 219/20000 [17:41:45<2127:54:05, 387.26s/it]
[debugging] num blocks: 43
{'loss': 0.7416, 'learning_rate': 1e-08, 'epoch': 3.49}

  1%|█▌                                                                                                                                            | 220/20000 [17:49:12<2225:58:17, 405.13s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 221/20000 [17:57:17<2358:42:12, 429.31s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 222/20000 [18:05:03<2418:34:15, 440.23s/it]
[debugging] num blocks: 43


  1%|█▌                                                                                                                                            | 224/20000 [18:20:33<2486:20:38, 452.61s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 463165.0424003601, 'epoch': 3.56}
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 225/20000 [18:26:42<2349:28:08, 427.72s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 226/20000 [18:35:27<2508:39:50, 456.72s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 227/20000 [18:43:26<2546:27:36, 463.62s/it]
[debugging] num blocks: 43

  1%|█▌                                                                                                                                            | 228/20000 [18:51:25<2570:43:57, 468.07s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 229/20000 [19:00:59<2745:48:55, 499.97s/it]
[debugging] num blocks: 43
{'loss': 0.7, 'learning_rate': 1e-08, 'epoch': 3.65}


  1%|█▋                                                                                                                                            | 231/20000 [19:15:09<2525:28:35, 459.90s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 404912.8918647766, 'epoch': 3.67}
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 232/20000 [19:22:51<2528:21:42, 460.45s/it]
[debugging] num blocks: 43


  1%|█▋                                                                                                                                            | 234/20000 [19:37:37<2467:33:31, 449.42s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 419439.3382072449, 'epoch': 3.71}
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 235/20000 [19:44:58<2453:33:52, 446.89s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 236/20000 [19:52:10<2428:49:55, 442.41s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 237/20000 [19:59:13<2397:52:51, 436.79s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 238/20000 [20:07:01<2449:16:18, 446.18s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 239/20000 [20:14:19<2434:18:08, 443.47s/it]
[debugging] num blocks: 43
{'loss': 0.7066, 'learning_rate': 1e-08, 'epoch': 3.81}


  1%|█▋                                                                                                                                            | 241/20000 [20:29:42<2482:34:09, 452.31s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 457394.26732063293, 'epoch': 3.83}
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 242/20000 [20:37:21<2493:50:41, 454.39s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 243/20000 [20:44:44<2475:28:36, 451.07s/it]
[debugging] num blocks: 43


  1%|█▋                                                                                                                                            | 245/20000 [20:59:17<2434:16:59, 443.61s/it]
[debugging] num blocks: 43

  1%|█▋                                                                                                                                            | 246/20000 [21:06:02<2370:35:56, 432.02s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 247/20000 [21:14:00<2446:51:27, 445.94s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 248/20000 [21:20:25<2345:17:57, 427.45s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 384309.20147895813, 'epoch': 3.94}
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 249/20000 [21:28:26<2433:43:21, 443.59s/it]
[debugging] num blocks: 43
{'loss': 0.7341, 'learning_rate': 1e-08, 'epoch': 3.97}


  1%|█▊                                                                                                                                            | 251/20000 [21:42:20<2352:34:41, 428.85s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 252/20000 [21:45:50<1992:12:52, 363.17s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 209936.10405921936, 'epoch': 4.0}

  1%|█▊                                                                                                                                            | 253/20000 [21:52:54<2091:51:52, 381.36s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 254/20000 [22:01:00<2264:52:57, 412.92s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 255/20000 [22:07:15<2202:21:00, 401.54s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 256/20000 [22:14:39<2272:10:47, 414.30s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 257/20000 [22:22:04<2322:40:26, 423.52s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 445047.6086139679, 'epoch': 4.08}
[debugging] num blocks: 43


  1%|█▊                                                                                                                                            | 259/20000 [22:36:41<2341:48:47, 427.06s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 393496.90222740173, 'epoch': 4.11}
[debugging] num blocks: 43
{'loss': 0.7409, 'learning_rate': 1e-08, 'epoch': 4.13}


  1%|█▊                                                                                                                                            | 261/20000 [22:51:07<2362:21:38, 430.85s/it]
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 262/20000 [23:00:17<2558:22:16, 466.62s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 550078.1133174896, 'epoch': 4.16}
[debugging] num blocks: 43

  1%|█▊                                                                                                                                            | 263/20000 [23:08:07<2564:00:32, 467.67s/it]
[debugging] num blocks: 43


  1%|█▉                                                                                                                                            | 265/20000 [23:22:31<2448:46:37, 446.70s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 266/20000 [23:29:46<2429:31:43, 443.21s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 267/20000 [23:36:31<2367:32:20, 431.92s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 268/20000 [23:44:38<2457:41:16, 448.39s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 269/20000 [23:51:17<2375:46:17, 433.47s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 398640.3913497925, 'epoch': 4.27}
[debugging] num blocks: 43
{'loss': 0.6935, 'learning_rate': 1e-08, 'epoch': 4.29}


  1%|█▉                                                                                                                                            | 271/20000 [24:07:17<2539:04:26, 463.31s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 272/20000 [24:14:43<2510:36:18, 458.14s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 273/20000 [24:22:01<2476:05:40, 451.86s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 437215.6891822815, 'epoch': 4.33}
[debugging] num blocks: 43


  1%|█▉                                                                                                                                            | 275/20000 [24:35:42<2333:13:10, 425.83s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 276/20000 [24:42:57<2348:39:14, 428.67s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 277/20000 [24:49:28<2287:40:44, 417.57s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 391638.9377117157, 'epoch': 4.4}
[debugging] num blocks: 43


  1%|█▉                                                                                                                                            | 279/20000 [25:04:09<2359:42:50, 430.76s/it]
[debugging] num blocks: 43

  1%|█▉                                                                                                                                            | 280/20000 [25:11:20<2359:58:31, 430.83s/it]
[debugging] num blocks: 43
{'loss': 0.7399, 'learning_rate': 1e-08, 'epoch': 4.44}

  1%|█▉                                                                                                                                            | 281/20000 [25:19:10<2425:16:31, 442.77s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 282/20000 [25:26:47<2448:20:31, 447.00s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 283/20000 [25:33:48<2405:00:07, 439.11s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 420695.09291648865, 'epoch': 4.49}
[debugging] num blocks: 43


  1%|██                                                                                                                                            | 285/20000 [25:49:29<2495:51:48, 455.75s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 286/20000 [25:53:55<2183:12:37, 398.68s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 287/20000 [26:01:32<2279:15:41, 416.24s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 457207.5309753418, 'epoch': 4.56}
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 288/20000 [26:07:51<2218:47:41, 405.22s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 289/20000 [26:14:08<2171:00:49, 396.51s/it]
[debugging] num blocks: 43
{'loss': 0.7387, 'learning_rate': 1e-08, 'epoch': 4.6}

  1%|██                                                                                                                                            | 290/20000 [26:21:27<2241:14:37, 409.36s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 291/20000 [26:29:20<2346:20:25, 428.58s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 292/20000 [26:36:55<2389:10:26, 436.42s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 293/20000 [26:44:35<2428:29:58, 443.63s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 294/20000 [26:51:58<2426:08:26, 443.22s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 295/20000 [27:00:10<2506:13:20, 457.87s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 296/20000 [27:07:15<2452:40:38, 448.11s/it]
[debugging] num blocks: 43

  1%|██                                                                                                                                            | 297/20000 [27:14:47<2458:33:48, 449.21s/it]
[debugging] num blocks: 43


  1%|██                                                                                                                                            | 299/20000 [27:28:06<2325:46:35, 424.99s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 411480.6971549988, 'epoch': 4.75}
[debugging] num blocks: 43
{'loss': 0.7361, 'learning_rate': 1e-08, 'epoch': 4.76}

  2%|██▏                                                                                                                                           | 300/20000 [27:35:09<2321:34:43, 424.25s/it]
[debugging] num blocks: 43


  2%|██▏                                                                                                                                           | 302/20000 [27:49:51<2369:33:02, 433.06s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 443009.3581676483, 'epoch': 4.79}
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 303/20000 [27:56:12<2284:16:54, 417.50s/it]
[debugging] num blocks: 43


  2%|██▏                                                                                                                                           | 305/20000 [28:10:06<2275:49:02, 415.99s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 402783.6961746216, 'epoch': 4.84}
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 306/20000 [28:16:44<2246:01:30, 410.57s/it]
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 307/20000 [28:24:14<2310:37:39, 422.40s/it]
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 308/20000 [28:30:47<2261:04:47, 413.36s/it]
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 309/20000 [28:38:10<2309:47:23, 422.29s/it]
[debugging] num blocks: 43
{'loss': 0.7186, 'learning_rate': 1e-08, 'epoch': 4.92}

  2%|██▏                                                                                                                                           | 310/20000 [28:47:32<2539:02:25, 464.22s/it]
[debugging] num blocks: 43


  2%|██▏                                                                                                                                           | 312/20000 [29:01:37<2418:11:48, 442.17s/it]
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 313/20000 [29:09:10<2435:13:56, 445.31s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 452623.59833717346, 'epoch': 4.97}
[debugging] num blocks: 43

  2%|██▏                                                                                                                                           | 314/20000 [29:15:50<2361:12:44, 431.80s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 220687.2034072876, 'epoch': 5.0}

  2%|██▏                                                                                                                                           | 315/20000 [29:19:31<2014:47:32, 368.47s/it]
[debugging] num blocks: 43


  2%|██▎                                                                                                                                           | 317/20000 [29:35:13<2335:04:47, 427.08s/it]
[debugging] num blocks: 43

  2%|██▎                                                                                                                                           | 318/20000 [29:43:53<2487:49:57, 455.05s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 520281.01563453674, 'epoch': 5.05}
[debugging] num blocks: 43


  2%|██▎                                                                                                                                           | 320/20000 [30:06:05<3119:06:12, 570.57s/it]
[debugging] num blocks: 43
{'loss': 0.7418, 'learning_rate': 1e-08, 'epoch': 5.08}
{'peak_mem': 48.82130432128906, 'step_consumption': 756160.5587005615, 'epoch': 5.08}
[debugging] num blocks: 43

  2%|██▎                                                                                                                                           | 321/20000 [30:16:04<3166:27:20, 579.26s/it]
[debugging] num blocks: 43

  2%|██▎                                                                                                                                           | 322/20000 [30:26:48<3271:34:48, 598.52s/it]
[debugging] num blocks: 43


  2%|██▎                                                                                                                                           | 324/20000 [30:46:58<3284:48:16, 601.00s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 595840.4245376587, 'epoch': 5.14}
[debugging] num blocks: 43


  2%|██▎                                                                                                                                           | 326/20000 [31:05:26<3154:15:11, 577.17s/it]
[debugging] num blocks: 43

  2%|██▎                                                                                                                                           | 327/20000 [31:14:23<3087:58:15, 565.07s/it]
[debugging] num blocks: 43
{'peak_mem': 48.82130432128906, 'step_consumption': 536833.3697319031, 'epoch': 5.19}
[debugging] num blocks: 43

  2%|██▎                                                                                                                                           | 328/20000 [31:24:23<3144:27:44, 575.44s/it]Traceback (most recent call last):
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 726, in <module>
    main()
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 678, in main
    framework.train(train_samples, dev_samples if dev_samples is not None else eval_samples, eval_samples)
  File "/home/rinya/ZO-LLM-main/zo-bench/run.py", line 563, in train
    trainer.train(resume_from_checkpoint=last_checkpoint)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/trainer.py", line 1662, in train
    return inner_training_loop(
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 497, in _inner_training_loop
    tr_loss_step = self.zo_step_with_module_wise_perturbation_coordinate(model, inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 893, in zo_step_with_module_wise_perturbation_coordinate
    loss2 = self.zo_forward(model, inputs)
  File "/home/rinya/ZO-LLM-main/zo-bench/trainer.py", line 747, in zo_forward
    loss = self.compute_loss(model, inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/transformers/trainer.py", line 2731, in compute_loss
    outputs = model(**inputs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/rinya/anaconda3/envs/zollm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/rinya/ZO-LLM-main/zo-bench/utils.py", line 103, in forward_wrap_with_option_len
    if any([x != num_options[0] for x in num_options]):
KeyboardInterrupt